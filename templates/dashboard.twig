<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <style>
    body {
      background-color: #f8f9fa;
    }
  .cards-container { 
    display: flex; flex-wrap: wrap; gap: 1rem; margin-top: 2rem; } 
    .card-summary { display: flex; justify-content: space-between; align-items: center; border-radius: 8px; padding: 1rem; width: 250px; background-color: #fff; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1); transition: transform 0.2s; cursor: pointer; }
     .card-summary:hover { transform: translateY(-4px); } 
     .card-label { margin: 0; font-weight: bold; color: #343a40; } 
    .card-value { margin: 0; font-size: 1.5rem; }
     .card-icon { display: flex; align-items: center; justify-content: center; width: 60px; height: 60px; border-radius: 12px; } 
     .cards-container { display: flex; gap: 20px; flex-wrap: wrap; }
      .card { background-color: #ffffff; border: 2px solid #e0e0e0; border-radius: 10px; padding: 1.5rem 12px; cursor: pointer; transition: 0.3s; width: 330px; } 
      .card:hover { transform: translateY(-4px); box-shadow: 0 4px 10px rgba(0,0,0,0.1); } .card-title { margin-top: 1rem; font-size: 1.2rem; font-weight: 600; } 
      .card-subtitle { margin: 4px 0; font-size: 1rem; color: #666; } 
      .quick-cards-container { display: flex; gap: 20px; flex-wrap: wrap; } .quick-card { background-color: #ffffff; border: 2px solid #e0e0e0; border-radius: 10px; padding: 1.5rem 12px; cursor: pointer; transition: 0.3s; width: 330px; display: flex; align-items: center; gap: 1rem; } 
      .quick-card:hover { transform: translateY(-4px); box-shadow: 0 4px 10px rgba(0,0,0,0.1); } .quick-card-icon { font-size: 2rem; width: 50px; height: 50px; display: flex; align-items: center; justify-content: center; border-radius: 50%; } 
      .quick-card-title { margin-top: 1rem; font-size: 1.2rem; font-weight: 600; } .quick-card-subtitle { margin: 4px 0; font-size: 1rem; color: #666; }

    .icon-blue { color: #0d6efd; }
    .icon-green { color: #28a745; }
    .icon-orange { color: #fd7e14; }

  </style>
</head>
<body>

<div class="container py-4">

  <!-- Header with logout -->
  <div class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center mb-4">
    <div>
      <h1 class="mb-1">Dashboard Overview</h1>
      <h6 id="welcomeMessage" class="text-muted mb-0 ">Welcome, User ðŸ‘‹</h6>
    </div>
    <div class="mt-3 mt-md-0">
      <button id="logoutBtn" class="btn btn-danger fw-semibold px-4 py-2 rounded-3">Logout</button>
    </div>
  </div>

  <!-- Ticket Overview -->
  <div class="mb-4">
    <h2 class="text-dark mb-3">Ticket Overview</h2>
    <div id="cardsContainer" class="cards-container"></div>
  </div>

  <!-- Quick Actions -->
  <div class="mb-6">
    <h3 class="mb-3">Quick Actions</h3>
    <div class="quick-cards-container">
      <!-- Add New Card -->
      <div class="quick-card" onclick="navigateTo('/create-ticket')">
        <div class="quick-card-icon icon-blue bg-light">
          <i class="bi bi-plus"></i>
        </div>
        <div>
          <p class="quick-card-title">Add New</p>
          <p class="quick-card-subtitle">Create something new</p>
        </div>
      </div>

      <!-- Tickets Card -->
      <div class="quick-card" onclick="navigateTo('/all-tickets')">
        <div class="quick-card-icon icon-green bg-light">
          <i class="bi bi-ticket-detailed"></i>
        </div>
        <div>
          <p class="quick-card-title">Tickets</p>
          <p class="quick-card-subtitle">View your tickets</p>
        </div>
      </div>

      <!-- Active Tickets Card -->
      <div class="quick-card" onclick="navigateTo('/active-tickets')">
        <div class="quick-card-icon icon-orange bg-light">
          <i class="bi bi-clock"></i>
        </div>
        <div>
          <p class="quick-card-title">Active Tickets</p>
          <p class="quick-card-subtitle">Tickets that are still in progress</p>
        </div>
      </div>
    </div>
  </div>

</div>
 <script src="/js/TicketStore.js"></script>
<script>
 function navigateTo(route, params = {}) {
    window.location.href = route;
   }
  // Welcome message and logout
  const welcomeMessage = document.getElementById('welcomeMessage');
  const logoutBtn = document.getElementById('logoutBtn');
  let currentUser = null;
  try {
    const storedUser = localStorage.getItem('ticketapp_session');
    if (storedUser) {
      currentUser = JSON.parse(storedUser);
      welcomeMessage.textContent = `Welcome, ${currentUser.firstName} ${currentUser.lastName} ðŸ‘‹`;
    } else {
      window.location.href = '/login' ;
    }
  } catch (err) {
    window.location.href = '/login ';
  }

  logoutBtn.addEventListener('click', () => {
    if (confirm('Are you sure you want to logout?')) {
      localStorage.removeItem('ticketapp_session');
      window.location.href = '/';
    }
  });
</script>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const ticketStore = new TicketStore();

  
    const tickets = ticketStore.getTickets() || [];

    
    const total = tickets.length;
    const openCount = tickets.filter(t => t.status === "Open").length;
    const inProgressCount = tickets.filter(t => t.status === "In Progress").length;
    const closedCount = tickets.filter(t => t.status === "Closed").length;

   
    console.log("Tickets loaded:", tickets);
    console.log(`Total: ${total}, Open: ${openCount}, In Progress: ${inProgressCount}, Closed: ${closedCount}`);

   
    const cardData = [
      { label: 'Total Tickets', value: total, icon: 'bi-ticket-detailed', iconColor:'#6c757d', iconBackgroundColor:'#e9ecef' },
      { label: 'Open Tickets', value: openCount, icon: 'bi-folder', iconColor:'#28a745', iconBackgroundColor:'#d4edda' },
      { label: 'In Progress', value: inProgressCount, icon: 'bi-arrow-repeat', iconColor:'#ffc107', iconBackgroundColor:'#fff8e1' },
      { label: 'Closed Tickets', value: closedCount, icon: 'bi-x-circle', iconColor:'#dc3545', iconBackgroundColor:'#f8d7da' },
    ];

   
    const container = document.getElementById('cardsContainer');
    container.innerHTML = ''; // Clear old content

    cardData.forEach(card => {
      const cardEl = document.createElement('div');
      cardEl.className = 'card-summary shadow-sm d-flex justify-content-between align-items-center p-3 mb-3 rounded border';
      cardEl.innerHTML = `
        <div>
          <p class="card-label mb-1 fw-semibold">${card.label}</p>
          <h4 class="card-value mb-0" style="color: ${card.iconColor}">${card.value}</h4>
        </div>
        <div class="card-icon d-flex justify-content-center align-items-center rounded-circle" 
             style="width: 50px; height: 50px; background-color:${card.iconBackgroundColor}; color:${card.iconColor}">
          <i class="bi ${card.icon} fs-4"></i>
        </div>
      `;
      container.appendChild(cardEl);
    });
  });
</script>

</body>
</html>
